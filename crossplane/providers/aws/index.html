<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="How to install and configure the UXP AWS provider"><link href=https://vmware-tanzu.github.io/tanzu-application-platform-reference-service-packages/crossplane/providers/aws/ rel=canonical><link href=../../ rel=prev><link href=../azure/ rel=next><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.4.2, mkdocs-material-9.0.11"><title>UXP AWS provider - Tanzu Application Platform Reference Service Packages</title><link rel=stylesheet href=../../../assets/stylesheets/main.0d440cfe.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.2505c338.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Metropolis,Avenir+Next,Helvetica+Neue,Arial,sans-serif:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Metropolis,Avenir Next,Helvetica Neue,Arial,sans-serif";--md-code-font:"JetBrains Mono"}</style><link rel=stylesheet href=../../../assets/extra.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary data-md-color-accent> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#installation class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-component=outdated hidden> </div> <header class="md-header md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title="Tanzu Application Platform Reference Service Packages" class="md-header__button md-logo" aria-label="Tanzu Application Platform Reference Service Packages" data-md-component=logo> <img src=../../../assets/vm-logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Tanzu Application Platform Reference Service Packages </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> UXP AWS provider </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary data-md-color-accent aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/vmware-tanzu/tanzu-application-platform-reference-service-packages title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> vmware-tanzu/tanzu-application-platform-reference-service-packages </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> HOME </a> </li> <li class=md-tabs__item> <a href=../../../usecases/aws/packages/elasticache/ack/ class=md-tabs__link> Use cases </a> </li> <li class=md-tabs__item> <a href=../../ class="md-tabs__link md-tabs__link--active"> Crossplane </a> </li> <li class=md-tabs__item> <a href=../../../ci/ class=md-tabs__link> CI </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="Tanzu Application Platform Reference Service Packages" class="md-nav__button md-logo" aria-label="Tanzu Application Platform Reference Service Packages" data-md-component=logo> <img src=../../../assets/vm-logo.png alt=logo> </a> Tanzu Application Platform Reference Service Packages </label> <div class=md-nav__source> <a href=https://github.com/vmware-tanzu/tanzu-application-platform-reference-service-packages title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> vmware-tanzu/tanzu-application-platform-reference-service-packages </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> HOME </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> Use cases <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Use cases </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1> <label class=md-nav__link for=__nav_2_1 id=__nav_2_1_label tabindex=0> AWS <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> AWS </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1_1> <label class=md-nav__link for=__nav_2_1_1 id=__nav_2_1_1_label tabindex=0> Packages <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_1_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1_1> <span class="md-nav__icon md-icon"></span> Packages </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1_1_1> <label class=md-nav__link for=__nav_2_1_1_1 id=__nav_2_1_1_1_label tabindex=0> Elasticache with ACK <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_1_1_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1_1_1> <span class="md-nav__icon md-icon"></span> Elasticache with ACK </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../usecases/aws/packages/elasticache/ack/ class=md-nav__link> Consuming AWS Elasticache with ACK </a> </li> <li class=md-nav__item> <a href=../../../usecases/aws/packages/elasticache/ack/manual/ class=md-nav__link> Creating AWS Elasticache Instances manually using kubectl (experimental) </a> </li> <li class=md-nav__item> <a href=../../../usecases/aws/packages/elasticache/ack/package/ class=md-nav__link> Creating AWS Elasticache instances by using a Carvel package (experimental) </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1_2> <label class=md-nav__link for=__nav_2_1_2 id=__nav_2_1_2_label tabindex=0> Prerequisites <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_1_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1_2> <span class="md-nav__icon md-icon"></span> Prerequisites </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../usecases/aws/prerequisites/ class=md-nav__link> AWS prerequisites </a> </li> <li class=md-nav__item> <a href=../../../usecases/aws/prerequisites/eks/ class=md-nav__link> Create an EKS cluster with EBS CSI driver </a> </li> <li class=md-nav__item> <a href=../../../usecases/aws/prerequisites/ack/ class=md-nav__link> Install the AWS Controllers for Kubernetes (ACK) </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex=0> Azure <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Azure </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_1> <label class=md-nav__link for=__nav_2_2_1 id=__nav_2_2_1_label tabindex=0> Packages <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_1> <span class="md-nav__icon md-icon"></span> Packages </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_1_1> <label class=md-nav__link for=__nav_2_2_1_1 id=__nav_2_2_1_1_label tabindex=0> MongoDB with Crossplane <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_2_1_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_1_1> <span class="md-nav__icon md-icon"></span> MongoDB with Crossplane </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../usecases/azure/packages/mongodb/crossplane/ class=md-nav__link> Consume MongoDB via Crossplane </a> </li> <li class=md-nav__item> <a href=../../../usecases/azure/packages/mongodb/crossplane/consume-instance/ class=md-nav__link> Via Crossplane Instances </a> </li> <li class=md-nav__item> <a href=../../../usecases/azure/packages/mongodb/crossplane/consume-package/ class=md-nav__link> Via Crossplane Package </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_2> <label class=md-nav__link for=__nav_2_2_2 id=__nav_2_2_2_label tabindex=0> Prerequisites <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_2> <span class="md-nav__icon md-icon"></span> Prerequisites </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../usecases/azure/prerequisites/ class=md-nav__link> Azure Packages Prerequisites </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex=0> Multicloud <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Multicloud </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1> <label class=md-nav__link for=__nav_2_3_1 id=__nav_2_3_1_label tabindex=0> Packages <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1> <span class="md-nav__icon md-icon"></span> Packages </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_1> <label class=md-nav__link for=__nav_2_3_1_1 id=__nav_2_3_1_1_label tabindex=0> Postgresql with Crossplane <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_1_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_1> <span class="md-nav__icon md-icon"></span> Postgresql with Crossplane </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../usecases/multicloud/packages/psql/ class=md-nav__link> Consuming Postgresql Multicloud </a> </li> <li class=md-nav__item> <a href=../../../usecases/multicloud/packages/psql/create/ class=md-nav__link> Creating the Postgresql Multicloud Crossplane package </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> Crossplane <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Crossplane </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ class=md-nav__link> Install Crossplane </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2 checked> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0> Providers <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=true> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Providers </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> UXP AWS provider <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> UXP AWS provider </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#installation class=md-nav__link> Installation </a> </li> <li class=md-nav__item> <a href=#create-iam-role-and-policy class=md-nav__link> Create IAM role and policy </a> </li> <li class=md-nav__item> <a href=#create-kubernetes-resources class=md-nav__link> Create Kubernetes resources </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../azure/ class=md-nav__link> UXP Azure provider </a> </li> <li class=md-nav__item> <a href=../terraform/ class=md-nav__link> UXP Terraform provider </a> </li> <li class=md-nav__item> <a href=../helm/ class=md-nav__link> Helm provider </a> </li> <li class=md-nav__item> <a href=../kubernetes/ class=md-nav__link> Kubernetes provider </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> CI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> CI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../ci/ class=md-nav__link> Continuous Integration </a> </li> <li class=md-nav__item> <a href=../../../ci/documentation/ class=md-nav__link> Documentation </a> </li> <li class=md-nav__item> <a href=../../../ci/carvel-crossplane-packages/ class=md-nav__link> Carvel and Crossplane packages </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#installation class=md-nav__link> Installation </a> </li> <li class=md-nav__item> <a href=#create-iam-role-and-policy class=md-nav__link> Create IAM role and policy </a> </li> <li class=md-nav__item> <a href=#create-kubernetes-resources class=md-nav__link> Create Kubernetes resources </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>UXP AWS provider</h1> <p>Upbound Universal Crossplane (UXP) AWS provider is a provider for Amazon Web Services developed and supported by Upbound.</p> <p>It can be deployed on top of a Kubernetes cluster with Crossplane, by using either the Upbound CLI (see <a href=../../ >here</a> for details about installation) or a YAML manifest.</p> <h2 id=installation>Installation<a class=headerlink href=#installation title="Permanent link">&para;</a></h2> <p>You can check available releases on <a href=https://github.com/upbound/provider-aws/releases>project's GitHub repository</a> or using <a href=https://cli.github.com/ ><code>gh</code></a> like</p> <div class=highlight><pre><span></span><code>gh<span class=w> </span>release<span class=w> </span>list<span class=w> </span>--repo<span class=w> </span>upbound/provider-aws
</code></pre></div> <p>and store the desired release into the <code>PROVIDER_AWS_RELEASE</code> variable.</p> <div class="admonition note"> <div class="tabbed-set tabbed-alternate" data-tabs=1:2><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>Upbound CLI</label><label for=__tabbed_1_2>YAML manifest</label></div> <div class=tabbed-content> <div class=tabbed-block> <p>Do make sure you have installed the <code>up</code> CLI as described <a href=../../ >here</a> and execute <div class=highlight><pre><span></span><code>up<span class=w> </span>controlplane<span class=w> </span>provider<span class=w> </span>install<span class=w> </span>xpkg.upbound.io/upbound/provider-aws:<span class=si>${</span><span class=nv>PROVIDER_AWS_RELEASE</span><span class=si>}</span><span class=w> </span>--name<span class=w> </span>upbound-provider-aws
</code></pre></div></p> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code>kubectl<span class=w> </span>apply<span class=w> </span>-f<span class=w> </span>-<span class=w> </span><span class=s>&lt;&lt;EOF</span>
<span class=s>apiVersion: pkg.crossplane.io/v1</span>
<span class=s>kind: Provider</span>
<span class=s>metadata:</span>
<span class=s>  name: upbound-provider-aws</span>
<span class=s>spec:</span>
<span class=s>  package: xpkg.upbound.io/upbound/provider-aws:${PROVIDER_AWS_RELEASE}</span>
<span class=s>EOF</span>
</code></pre></div> </div> </div> </div> </div> <p>It is now necessary to configure the provider's authentication to the AWS API endpoints.</p> <p>The authentication method can vary based on your company's policies: for example, you might be allowed to use long-term credentials such as access key and secret access key pairs, however, if your Kubernetes platform is AWS EKS, it's much more secure to use <a href=https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html>IAM roles for service accounts (IRSA)</a>.</p> <p>Please make sure you do create the OIDC provider as described in the <a href=../../../usecases/aws/prerequisites/eks/ >EKS set-up guide</a> before reading on. The following paragraphs explain how to configure IRSA for the Crossplane AWS provider.</p> <h2 id=create-iam-role-and-policy>Create IAM role and policy<a class=headerlink href=#create-iam-role-and-policy title="Permanent link">&para;</a></h2> <p>You must create a proper role for the provider to assume, for granting the necessary and sufficient permissions to manage the AWS infrastructure. The least-privilege principle applies, therefore it's important to understand the actual needs and create the permission policy accordingly. For example, the following snippet creates a policy that allows the role it's attached to to execute actions only on the S3 service.</p> <p>First of all, set your the AWS region you're operating in and your EKS cluster name.</p> <div class=highlight><pre><span></span><code><span class=c1># AWS region you&#39;re operating in</span>
<span class=nb>export</span><span class=w> </span><span class=nv>AWS_REGION</span><span class=o>=</span><span class=s2>&quot;eu-central-1&quot;</span>

<span class=c1># EKS cluster name</span>
<span class=nv>CLUSTER_NAME</span><span class=o>=</span><span class=s2>&quot;my-eks-cluster&quot;</span>

<span class=c1># define variables for IAM</span>
<span class=nv>ACCOUNT_ID</span><span class=o>=</span><span class=k>$(</span>aws<span class=w> </span>sts<span class=w> </span>get-caller-identity<span class=w> </span>--query<span class=w> </span>Account<span class=w> </span>--output<span class=w> </span>text<span class=k>)</span>
<span class=nv>OIDC_ID</span><span class=o>=</span><span class=k>$(</span>aws<span class=w> </span>eks<span class=w> </span>describe-cluster<span class=w> </span>--name<span class=w> </span><span class=si>${</span><span class=nv>CLUSTER_NAME</span><span class=si>}</span><span class=w> </span>--output<span class=w> </span>text<span class=w> </span>--query<span class=w> </span><span class=s2>&quot;cluster.identity.oidc.issuer&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>cut<span class=w> </span>-d/<span class=w> </span>-f3-<span class=k>)</span>
<span class=nv>CROSSPLANE_ROLE</span><span class=o>=</span><span class=s2>&quot;crossplane-for-</span><span class=si>${</span><span class=nv>CLUSTER_NAME</span><span class=si>}</span><span class=s2>&quot;</span>
<span class=nv>ROLE_TRUST_POLICY</span><span class=o>=</span><span class=k>$(</span>mktemp<span class=k>)</span>
<span class=nv>ROLE_PERMISSION_POLICY</span><span class=o>=</span><span class=k>$(</span>mktemp<span class=k>)</span>
</code></pre></div> <p>You can then define the role's trust policy, in order to allow Crossplane AWS provider's service account to assume it as WebIdentity, and then create the role.</p> <div class=highlight><pre><span></span><code><span class=c1># prepare the trust policy document</span>
cat<span class=w> </span>&gt;<span class=w> </span><span class=si>${</span><span class=nv>ROLE_TRUST_POLICY</span><span class=si>}</span><span class=w> </span><span class=s>&lt;&lt;EOF</span>
<span class=s>{</span>
<span class=s>    &quot;Version&quot;: &quot;2012-10-17&quot;,</span>
<span class=s>    &quot;Statement&quot;: [{</span>
<span class=s>        &quot;Effect&quot;: &quot;Allow&quot;,</span>
<span class=s>        &quot;Principal&quot;: {</span>
<span class=s>            &quot;Federated&quot;: &quot;arn:aws:iam::${ACCOUNT_ID}:oidc-provider/${OIDC_ID}&quot;</span>
<span class=s>        },</span>
<span class=s>        &quot;Action&quot;: &quot;sts:AssumeRoleWithWebIdentity&quot;,</span>
<span class=s>        &quot;Condition&quot;: {</span>
<span class=s>            &quot;StringLike&quot;: {</span>
<span class=s>                &quot;${OIDC_ID}:sub&quot;: &quot;system:serviceaccount:upbound-system:upbound-provider-aws-*&quot;</span>
<span class=s>            }</span>
<span class=s>        }</span>
<span class=s>    }]</span>
<span class=s>}</span>
<span class=s>EOF</span>

<span class=c1># create the role with the proper trust policy</span>
aws<span class=w> </span>iam<span class=w> </span>create-role<span class=w> </span>--role-name<span class=w> </span><span class=si>${</span><span class=nv>CROSSPLANE_ROLE</span><span class=si>}</span><span class=w> </span>--assume-role-policy-document<span class=w> </span>file://<span class=si>${</span><span class=nv>ROLE_TRUST_POLICY</span><span class=si>}</span>
</code></pre></div> <p>Now, the permission policies, that define which permissions are granted to the role, have to be created and attached to the role. For this example you will need just one policy, with a number of statements declaring what the role can or cannot do.</p> <div class=highlight><pre><span></span><code><span class=c1># create the permission policy document</span>
cat<span class=w> </span>&gt;<span class=w> </span><span class=si>${</span><span class=nv>ROLE_PERMISSION_POLICY</span><span class=si>}</span><span class=w> </span><span class=s>&lt;&lt;EOF</span>
<span class=s>{</span>
<span class=s>  &quot;Version&quot;: &quot;2012-10-17&quot;,</span>
<span class=s>  &quot;Statement&quot;: [</span>
<span class=s>    {</span>
<span class=s>      &quot;Action&quot;: &quot;s3:*&quot;,</span>
<span class=s>      &quot;Effect&quot;: &quot;Allow&quot;,</span>
<span class=s>      &quot;Resource&quot;: &quot;*&quot;</span>
<span class=s>    }</span>
<span class=s>  ]</span>
<span class=s>}</span>
<span class=s>EOF</span>

<span class=c1># create the permission policy</span>
<span class=nv>PERMISSION_POLICY_ARN</span><span class=o>=</span><span class=k>$(</span>aws<span class=w> </span>iam<span class=w> </span>create-policy<span class=w> </span>--policy-name<span class=w> </span><span class=si>${</span><span class=nv>CROSSPLANE_ROLE</span><span class=si>}</span><span class=w> </span>--policy-document<span class=w> </span>file://<span class=si>${</span><span class=nv>ROLE_PERMISSION_POLICY</span><span class=si>}</span><span class=w> </span>--query<span class=w> </span>Policy.Arn<span class=w> </span>--output<span class=w> </span>text<span class=k>)</span>

<span class=c1># attach the policy to the role</span>
aws<span class=w> </span>iam<span class=w> </span>attach-role-policy<span class=w> </span>--policy-arn<span class=w> </span><span class=si>${</span><span class=nv>PERMISSION_POLICY_ARN</span><span class=si>}</span><span class=w> </span>--role-name<span class=w> </span><span class=si>${</span><span class=nv>CROSSPLANE_ROLE</span><span class=si>}</span>

<span class=c1># clean up temporary files</span>
rm<span class=w> </span><span class=si>${</span><span class=nv>ROLE_TRUST_POLICY</span><span class=si>}</span>
rm<span class=w> </span><span class=si>${</span><span class=nv>ROLE_PERMISSION_POLICY</span><span class=si>}</span>
</code></pre></div> <h2 id=create-kubernetes-resources>Create Kubernetes resources<a class=headerlink href=#create-kubernetes-resources title="Permanent link">&para;</a></h2> <p>Create a <code>ProviderConfig</code> resource to specify IRSA as authentication method.</p> <div class=highlight><pre><span></span><code>kubectl<span class=w> </span>apply<span class=w> </span>-f<span class=w> </span>-<span class=w> </span><span class=s>&lt;&lt;EOF</span>
<span class=s>apiVersion: aws.upbound.io/v1beta1</span>
<span class=s>kind: ProviderConfig</span>
<span class=s>metadata:</span>
<span class=s>  name: default</span>
<span class=s>spec:</span>
<span class=s>  credentials:</span>
<span class=s>    source: IRSA</span>
<span class=s>EOF</span>
</code></pre></div> <p>Create a <code>ControllerConfig</code> resource to specify the AWS provider's settings, including the IRSA role to assume:</p> <div class=highlight><pre><span></span><code>kubectl<span class=w> </span>apply<span class=w> </span>-f<span class=w> </span>-<span class=w> </span><span class=s>&lt;&lt;EOF</span>
<span class=s>apiVersion: pkg.crossplane.io/v1alpha1</span>
<span class=s>kind: ControllerConfig</span>
<span class=s>metadata:</span>
<span class=s>  annotations:</span>
<span class=s>    eks.amazonaws.com/role-arn: arn:aws:iam::${ACCOUNT_ID}:role/${CROSSPLANE_ROLE}</span>
<span class=s>  name: aws-irsa</span>
<span class=s>EOF</span>
</code></pre></div> <p>and patch the AWS provider to use it:</p> <div class=highlight><pre><span></span><code>kubectl<span class=w> </span>patch<span class=w> </span>providers.pkg.crossplane.io<span class=w> </span>upbound-provider-aws<span class=w> </span>--type<span class=o>=</span><span class=s1>&#39;merge&#39;</span><span class=w> </span>--patch<span class=w> </span><span class=s1>&#39;{&quot;spec&quot;: { &quot;controllerConfigRef&quot;: { &quot;name&quot;: &quot;aws-irsa&quot; } } }&#39;</span>
</code></pre></div> <p>Destroy the existing pods to make sure that new ones will be created:</p> <div class=highlight><pre><span></span><code>kubectl<span class=w> </span>-n<span class=w> </span>upbound-system<span class=w> </span>delete<span class=w> </span>pods<span class=w> </span>-l<span class=w> </span>pkg.crossplane.io/provider<span class=o>=</span>upbound-provider-aws
</code></pre></div> <p>Now you can test the effectiveness of the configuration by creating a simple S3 bucket:</p> <div class=highlight><pre><span></span><code><span class=nv>BUCKET_NAME</span><span class=o>=</span><span class=k>$(</span>kubectl<span class=w> </span>create<span class=w> </span>-o<span class=w> </span>yaml<span class=w> </span>-f<span class=w> </span>-<span class=w> </span><span class=s>&lt;&lt;EOF | yq &#39;.metadata.name&#39;</span>
<span class=s>apiVersion: s3.aws.upbound.io/v1beta1</span>
<span class=s>kind: Bucket</span>
<span class=s>metadata:</span>
<span class=s>  generateName: crossplane-test-bucket-</span>
<span class=s>spec:</span>
<span class=s>  forProvider:</span>
<span class=s>    region: ${AWS_REGION}</span>
<span class=s>EOF</span>
<span class=k>)</span>
</code></pre></div> <p>and verify its status</p> <div class=highlight><pre><span></span><code><span class=hll>$<span class=w> </span>kubectl<span class=w> </span>get<span class=w> </span>buckets.s3.aws.upbound.io<span class=w> </span><span class=si>${</span><span class=nv>BUCKET_NAME</span><span class=si>}</span>
</span>NAME<span class=w>                           </span>READY<span class=w>   </span>SYNCED<span class=w>   </span>EXTERNAL-NAME<span class=w>                  </span>AGE
crossplane-test-bucket-cxr9g<span class=w>   </span>True<span class=w>    </span>True<span class=w>     </span>crossplane-test-bucket-cxr9g<span class=w>   </span>80s
</code></pre></div> <p>As the bucket is marked as synced, it's worth checking the status of the AWS resource:</p> <div class=highlight><pre><span></span><code><span class=hll>$<span class=w> </span>aws<span class=w> </span>s3api<span class=w> </span>list-buckets<span class=w> </span><span class=p>|</span><span class=w> </span>jq<span class=w> </span><span class=s1>&#39;.Buckets[]|select(.Name == &quot;&#39;</span><span class=si>${</span><span class=nv>BUCKET_NAME</span><span class=si>}</span><span class=s1>&#39;&quot;)&#39;</span>
</span><span class=o>{</span>
<span class=w>  </span><span class=s2>&quot;Name&quot;</span>:<span class=w> </span><span class=s2>&quot;crossplane-test-bucket-cxr9g&quot;</span>,
<span class=w>  </span><span class=s2>&quot;CreationDate&quot;</span>:<span class=w> </span><span class=s2>&quot;2022-11-05T00:36:49+00:00&quot;</span>
<span class=o>}</span>
</code></pre></div> <p>This proves that the provider is configured correctly and you can safely delete the test bucket:</p> <div class=highlight><pre><span></span><code>kubectl<span class=w> </span>delete<span class=w> </span>buckets.s3.aws.upbound.io<span class=w> </span><span class=si>${</span><span class=nv>BUCKET_NAME</span><span class=si>}</span>
</code></pre></div> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_datetime">2022-12-01 09:40:33</span> </small> </div> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2022 VMware </div> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["navigation.tabs", "navigation.instant", "navigation.tabs.sticky", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.db81ec45.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"method": "mike", "provider": "mike"}}</script> <script src=../../../assets/javascripts/bundle.6df46069.min.js></script> </body> </html>